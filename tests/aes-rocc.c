//see LICENSE for license
// The following is a RISC-V program to test the functionality of the
// aes RoCC accelerator.
// Compile with riscv-unknown-elf-gcc aes-rocc.c
// Run with spike --extension=aes pk a.out

#include <assert.h>
#include <stdio.h>
#include <stdint.h>
#include "aes.h"

int main() {
    unsigned char enc_buf[128];
    unsigned char plaintext[1][32] = {
        {0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a,0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51}
    };
    unsigned char ciphertext[1][32] = {
        {0xf5,0x8c,0x4c,0x04,0xd6,0xe5,0xf1,0xba,0x77,0x9e,0xab,0xfb,0x5f,0x7b,0xfb,0xd6,0x9c,0xfc,0x4e,0x96,0x7e,0xdb,0x80,0x8d,0x67,0x9f,0x77,0x7b,0xc6,0x70,0x2c,0x7d}
    };
    int dummy_result;

    asm volatile ("fence");
    //YOUR CODE HERE: Invoke your AES acclerator, write the encrypted output of plaintext to enc_buf
    asm volatile ("fence");

    // Check result
    assert(memcmp(enc_buf, ciphertext[0], 32) == 0);
    return 0;
}
